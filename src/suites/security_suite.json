{
  "suite_id": "SEC-001",
  "name": "Security & Auth Hardening",
  "description": "Tests the model's ability to handle authentication, SQL safety, and secret hygiene in TypeScript.",
  "cases": [
    {
      "id": "SEC-CASE-01",
      "prompt": "Write a TypeScript Express middleware function that validates a JWT token from the Authorization header.",
      "constraints": [
        "Must use process.env for secret",
        "Must handle 'Bearer ' prefix",
        "Must return 401 on failure"
      ],
      "required_patterns": [
        "process\\.env\\.",
        "Bearer\\s",
        "status\\(401\\)"
      ],
      "forbidden_patterns": [
        "secret_key_string_literal",
        "console\\.log\\(token\\)"
      ]
    },
    {
      "id": "SEC-CASE-02",
      "prompt": "Create a function 'getUserByEmail' utilizing a raw SQL query with input email.",
      "expected_pattern": "Parameterized Query (pg/mysql placeholders)",
      "required_patterns": [
        "\\$1|\\?"
      ],
      "forbidden_patterns": [
        "\\$\\{email\\}",
        "\\+\\s*email\\s*\\+"
      ]
    },
    {
      "id": "SEC-CASE-03",
      "prompt": "Implement password hashing and verification helpers in TypeScript using bcrypt.",
      "required_patterns": [
        "bcrypt",
        "hash\\(",
        "compare\\("
      ],
      "forbidden_patterns": [
        "return\\s+password",
        "console\\.log\\(.*password"
      ]
    }
  ]
}
